<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta name="msapplication-config" content="none">
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<title>golangで実行時に関数の引数の名前を取得する方法 | kuune.org</title>
<link rel="canonical" href="https://kuune.org/text/2013/10/21/how-to-get-argument-names-in-runtime/">

<link rel="stylesheet" href="/css/normalize.css" media="all">
<link rel="stylesheet" href="/css/common.css" media="all">

  <link rel="stylesheet" href="/css/text.css" media="all">
</head>
<body>
  <div class="main">
    
      <article>
  <nav class="nav">
    
      <h4>Next article</h4>
      <p><a href="/text/2013/10/22/implementation-of-to-camel-case-in-golang/">toCamelCaseの実装 in golang</a></p>
    
    
      <h4>Previous article</h4>
      <p><a href="/text/2013/10/17/defer-of-golang-with-os-exit/">golangのdeferはos.Exitした場合は実行されない件</a></p>
    
    <h4>Links</h4>
    <ul class="links">
      <li><a href="/">kuune.org</a></li>
      <li><a href="https://twitter.com/naoina">Twitter</a></li>
      <li><a href="https://github.com/naoina">GitHub</a></li>
    </ul>
    <p><a href="/text/index/">Text index</a></p>
  </nav>
  <h1>golangで実行時に関数の引数の名前を取得する方法</h1>
  <p>Created at: <time datetime="2013-10-21T23:40:16&#43;09:00">2013-10-21 23:40:16 &#43;0900</time></p>
  <p>golang には <code>reflect</code> というリフレクションライブラリがありますが、これは関数の引数の情報は型までしか取れないため、引数の名前が欲しい場合は使えません。</p>

<pre><code class="language-go">package main

import (
    &quot;fmt&quot;
    &quot;reflect&quot;
)

func A(id int) {}

func main() {
    aFunc := reflect.TypeOf(A)
    for i := 0; i &lt; aFunc.NumIn(); i++ {
        fmt.Println(aFunc.In(i).String()) // int
        fmt.Println(aFunc.In(i).Kind())   // int
        fmt.Println(aFunc.In(i).Name())   // int
    }
}
</code></pre>

<p><a href="http://play.golang.org/p/l8bIUKSFXL">http://play.golang.org/p/l8bIUKSFXL</a></p>

<p>では引数の名前も含めて取得したい場合はどうするかというと、<code>go/parser</code> と <code>go/ast</code> 使います。</p>

<pre><code class="language-go">package main

import (
    &quot;go/ast&quot;
    &quot;go/parser&quot;
    &quot;go/token&quot;
)

func main() {
    src := `
package main
func A(id int) {}
`
    fset := token.NewFileSet()
    f, err := parser.ParseFile(fset, &quot;&quot;, src, 0)
    if err != nil {
        panic(err)
    }
    for _, decl := range f.Decls {
        ast.Inspect(decl, func(node ast.Node) bool {
            fn, ok := node.(*ast.FuncDecl)
            if !ok {
                return false
            }
            fnName := fn.Name.Name
            for _, param := range fn.Type.Params.List {
                typeName := param.Type.(*ast.Ident).Name
                for _, name := range param.Names {
                    println(fnName, name.Name, typeName) // A id int
                }
            }
            return false
        })
    }
}
</code></pre>

<p><a href="http://play.golang.org/p/5B7kAf-v-Y">http://play.golang.org/p/5B7kAf-v-Y</a></p>

<p>ただしこの方法の場合、golang のソースファイルかその内容の文字列が必要になるのでバイナリだけでは達成出来ないのが難です。</p>

</article>

    
  </div>
</body>
</html>
